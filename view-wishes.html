<!DOCTYPE html>
<html>
<head>
  <title>WishWell - View Wishes</title>
  <link rel="stylesheet" href="css/style.css">
  

</head>
<body>
    <h1>🌟 WishWell - Wishes</h1>

    <div style="text-align: right; margin: 10px;"></div>
   

  <h2>All Submitted Wishes 👀</h2>
  <nav style="background-color: #4CAF50; padding: 10px;">
  <a href="index.html" style="color: white; margin-right: 20px; text-decoration: none;">🏠 Home</a>
  <a href="submit-wish.html" style="color: white; margin-right: 20px; text-decoration: none;">🎁 Submit Wish</a>
  <a href="wishes.html" style="color: white; margin-right: 20px; text-decoration: none;">👀 View Wishes</a>
  <a href="login.html" style="color: white; text-decoration: none;">🚪 Logout</a>
</nav>


  <div id="wishList">Loading wishes...</div>

  <button onclick="goBack()">⬅️ Back to Home</button>

  <script type="module">
    import { auth, db } from './firebase/firebase-config.js';
    import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { collection, getDocs, orderBy, query } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const wishList = document.getElementById('wishList');

    // Only allow logged-in users
    onAuthStateChanged(auth, async (user) => {
      if (!user) {
        window.location.href = "login.html";
      } else {
        // Fetch all wishes
        const q = query(collection(db, "wishes"), orderBy("timestamp", "desc"));
        const querySnapshot = await getDocs(q);

        if (querySnapshot.empty) {
          wishList.innerHTML = "<p>No wishes found 🙁</p>";
        } else {
          wishList.innerHTML = "";
          querySnapshot.forEach((doc) => {
            const data = doc.data();
            const wishCard = `
              <div style="border:1px solid #ccc; padding:10px; margin:10px;">
                <strong>Name:</strong> ${data.name}<br>
                <strong>Age:</strong> ${data.age}<br>
                <strong>Location:</strong> ${data.location}<br>
                <strong>Wish:</strong> ${data.wish}<br>
              </div>
            `;
            wishList.innerHTML += wishCard;
          });
        }
      }
    });

    // Back button
    window.goBack = () => {
      window.location.href = "index.html";
    };
  </script>
  <script type="module">
  async function loadLanguage(lang) {
    const res = await fetch(`lang/${lang}.json`);
    const translations = await res.json();

    document.querySelectorAll("[data-i18n]").forEach(el => {
      const key = el.getAttribute("data-i18n");
      if (translations[key]) {
        el.innerText = translations[key];
      }
    });
  }

  const languageSwitcher = document.getElementById("languageSwitcher");
  languageSwitcher.addEventListener("change", (e) => {
    localStorage.setItem("lang", e.target.value);
    loadLanguage(e.target.value);
  });

  const selectedLang = localStorage.getItem("lang") || "en";
  languageSwitcher.value = selectedLang;
  loadLanguage(selectedLang);
</script>

</body>
</html>
